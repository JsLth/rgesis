<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Retrieve data from the GESIS archive • rgesis</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Retrieve data from the GESIS archive">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rgesis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Overview</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/gesis-data.html"><span class="fa fa-book"></span> Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-search"></span> Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jslth/rgesis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Retrieve data from the GESIS archive</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jslth/rgesis/blob/main/vignettes/gesis-data.Rmd" class="external-link"><code>vignettes/gesis-data.Rmd</code></a></small>
      <div class="d-none name"><code>gesis-data.Rmd</code></div>
    </div>

    
    
<p>GESIS Search is a service by GESIS - Leibniz Institute for the Social
Sciences to look up information about research data, survey variables,
empirical instruments and tools, literature, and library collections
from the social sciences. <code>rgesis</code> is a package to query its
search engine to retrieve metadata on search records and to download
survey data from GESIS’ comprehensive data archive. It does so in a
reproducible manner that can easily be embedded in code files and
publications. The package mainly consists of three functions</p>
<ol style="list-style-type: decimal">
<li>Authenticate a session using <code><a href="../reference/gesis_auth.html">gesis_auth()</a></code>
</li>
<li>Search the GESIS catalogue using <code><a href="../reference/gesis_search.html">gesis_search()</a></code>
</li>
<li>Retrieve data using <code><a href="../reference/gesis_data.html">gesis_data()</a></code>
</li>
</ol>
<div class="section level2">
<h2 id="authentication">Authentication<a class="anchor" aria-label="anchor" href="#authentication"></a>
</h2>
<p>GESIS expects all users who wish to download a data file to be logged
in. The <code><a href="../reference/gesis_auth.html">gesis_auth()</a></code> function takes over this task purely
programmatically. You need to provide the function with a user email and
a password. This can be done either by passing them as function
arguments or by setting them as global options. It is recommended to do
the latter using a <code>.Rprofile</code> file. This can look something
like this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span></span>
<span>  gesis_email <span class="op">=</span> <span class="st">"jonas.lieth@gesis.org"</span>,</span>
<span>  gesis_password <span class="op">=</span> <span class="st">"****"</span>,</span>
<span>  gesis_download_purpose <span class="op">=</span> <span class="st">"non_scientific"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Here, I also specified a download purpose which must be specified to
download data. If you know that this purpose is not going to change
between queries, you can specify it globally.</p>
<p>When the credentials are set, you can run <code><a href="../reference/gesis_auth.html">gesis_auth()</a></code>
without arguments. This step 1. sends a login request, 2. checks if you
can login, and 3. stores the credentials in a secure <a href="https://keyring.r-lib.org/" class="external-link">keyring</a> storage. If you get a
success message, you are good to go.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gesis_auth.html">gesis_auth</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># ✔ Successfully performed GESIS login.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="gesis-search">GESIS Search<a class="anchor" aria-label="anchor" href="#gesis-search"></a>
</h2>
<p>Even without authentication, you can use <code>rgesis</code> to
retrieve metadata on GESIS search entries like datasets, variables,
publications or tools. This can be done using the
<code><a href="../reference/gesis_search.html">gesis_search()</a></code> function which offers tools for querying and
filtering the GESIS search engine. For example, to get metadata on the
German General Social Survey (ALLBUS) from 2018, you can do:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gesis_search.html">gesis_search</a></span><span class="op">(</span></span>
<span>  <span class="st">"allbus"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"research_data"</span>,</span>
<span>  collection_year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2018</span>, <span class="fl">2018</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; A list of <span style="color: #0000BB;">&lt;gesis_hits&gt;</span> with 10 hits</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;gesis_hit&gt;</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Type:</span> research_data</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">ID:</span> ZA5272</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Title:</span> German General Social Survey - ALLBUS 2018</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Date:</span> 2019</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Persons:</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Diekmann, Andreas</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Hadjar, Andreas</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Kurz, Karin</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Rosar, Ulrich</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Wagner, Ulrich</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> ... and 1 more</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;gesis_hit&gt;</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Type:</span> research_data</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">ID:</span> ZA5270</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Title:</span> Allgemeine Bevölkerungsumfrage der Sozialwissenschaften ALLBUS 2018</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Date:</span> 2019</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Persons:</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Diekmann, Andreas</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Hadjar, Andreas</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Kurz, Karin</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Rosar, Ulrich</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Wagner, Ulrich</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> ... and 1 more</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;gesis_hit&gt;</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Type:</span> research_data</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">ID:</span> ZA5260</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Title:</span> Allgemeine Bevölkerungsumfrage der Sozialwissenschaften - ALLBUS</span></span>
<span><span class="co">#&gt; Sensitive Regionaldaten</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Date:</span> 2021</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Persons:</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Allerbeck, Klaus</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Allmendinger, Jutta</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Andreß, Hans-Jürgen</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Bürklin, Wilhelm</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Diekmann, Andreas</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> ... and 21 more</span></span>
<span><span class="co">#&gt; <span style="color: #555555;"># ℹ 7 more hits</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"># ℹ Use `print(n = ...)` to see more hits</span></span></span></code></pre></div>
<p><code>"allbus"</code> is the query string,
<code>"research_data"</code> is the result type (you can also search for
other types like publications or tools), and <code>c(2018, 2018)</code>
is the time in which the queried dataset must be collected.</p>
<p>If you need this data in a more workable manner, you can set
<code>tidy = TRUE</code>. This will convert the metadata to a pretty
dataframe. Be aware that not all metadata fields can be fit in a
rectangular shape and must be dropped. If completeness of metadata
records is a priority, you should leave the output untidy.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gesis_search.html">gesis_search</a></span><span class="op">(</span></span>
<span>  <span class="st">"allbus"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"research_data"</span>,</span>
<span>  collection_year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2018</span>, <span class="fl">2018</span><span class="op">)</span>,</span>
<span>  tidy <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 104</span></span></span>
<span><span class="co">#&gt;    title            study_title id    date  date_recency study_number portal_url</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> German General … German Gen… ZA52… 2019  2018         ZA5272       https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Allgemeine Bevö… Allgemeine… ZA52… 2019  2018         ZA5270       https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Allgemeine Bevö… Allgemeine… ZA52… 2021  2018         ZA5260       https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Allgemeine Bevö… Allgemeine… ZA52… 2021  2018         ZA5274       https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> German General … German Gen… ZA52… 2021  2018         ZA5276       https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Allgemeine Bevö… Allgemeine… ZA52… 2021  2018         ZA5262       https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> German General … German Gen… ZA52… 2019  2018         ZA5273       https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> German General … German Gen… ZA52… 2021  2018         ZA5277       https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Allgemeine Bevö… Allgemeine… ZA52… 2019  2018         ZA5271       https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Allgemeine Bevö… Allgemeine… ZA52… 2021  2018         ZA5275       https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 97 more variables: person_sort &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   primary_researchers_advisory_board_institution &lt;list&gt;, type &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   subtype &lt;chr&gt;, abstract &lt;chr&gt;, source &lt;chr&gt;, time_collection &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   time_collection_max_year &lt;chr&gt;, time_collection_min_year &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   time_collection_years &lt;list&gt;, countries_collection &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   countries_iso &lt;list&gt;, countries_free &lt;list&gt;, countries_view &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   methodology_collection &lt;chr&gt;, analysis_system &lt;chr&gt;, …</span></span></span></code></pre></div>
<p>While the first 10 results are enough for many use cases, sometimes
you just need more than that. By default, <code><a href="../reference/gesis_search.html">gesis_search()</a></code>
only requests the first search page. You can choose which pages to
request by setting the <code>pages</code> argument. You can even request
all pages by setting it to <code>NULL</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gesis_search.html">gesis_search</a></span><span class="op">(</span></span>
<span>  <span class="st">"allbus"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"research_data"</span>,</span>
<span>  collection_year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2018</span>, <span class="fl">2018</span><span class="op">)</span>,</span>
<span>  tidy <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pages <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 13 × 120</span></span></span>
<span><span class="co">#&gt;    title            study_title id    date  date_recency study_number portal_url</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> German General … German Gen… ZA52… 2019  2018         ZA5272       https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Allgemeine Bevö… Allgemeine… ZA52… 2019  2018         ZA5270       https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Allgemeine Bevö… Allgemeine… ZA52… 2021  2018         ZA5260       https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Allgemeine Bevö… Allgemeine… ZA52… 2021  2018         ZA5274       https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> German General … German Gen… ZA52… 2021  2018         ZA5276       https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Allgemeine Bevö… Allgemeine… ZA52… 2021  2018         ZA5262       https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> German General … German Gen… ZA52… 2019  2018         ZA5273       https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> German General … German Gen… ZA52… 2021  2018         ZA5277       https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Allgemeine Bevö… Allgemeine… ZA52… 2019  2018         ZA5271       https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Allgemeine Bevö… Allgemeine… ZA52… 2021  2018         ZA5275       https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> Harmonizing and… Harmonizin… SDN-… 2021  2021         <span style="color: #BB0000;">NA</span>           https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> Harmonizing and… Harmonizin… SDN-… 2021  2021         <span style="color: #BB0000;">NA</span>           https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> Harmonizing and… Harmonizin… SDN-… 2021  2021         <span style="color: #BB0000;">NA</span>           https://d…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 113 more variables: person_sort &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   primary_researchers_advisory_board_institution &lt;list&gt;, type &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   subtype &lt;chr&gt;, abstract &lt;chr&gt;, source &lt;chr&gt;, time_collection &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   time_collection_max_year &lt;chr&gt;, time_collection_min_year &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   time_collection_years &lt;list&gt;, countries_collection &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   countries_iso &lt;list&gt;, countries_free &lt;list&gt;, countries_view &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   methodology_collection &lt;list&gt;, analysis_system &lt;chr&gt;, …</span></span></span></code></pre></div>
<p>To exemplify, we can perform a very basic bibliographic analysis of
the evolution of climate change literature based on the most relevant
5000 records in the GESIS archive.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gesis_search.html">gesis_search</a></span><span class="op">(</span></span>
<span>  <span class="st">"climate change"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"publication"</span>,</span>
<span>  pages <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">500</span>,</span>
<span>  tidy <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">cc</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"subtype"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, fill <span class="op">=</span> <span class="va">subtype</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_discrete</span><span class="op">(</span><span class="st">"Type"</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    book <span class="op">=</span> <span class="st">"Book"</span>,</span>
<span>    in_proceedings <span class="op">=</span> <span class="st">"Proceedings"</span>,</span>
<span>    journal_article <span class="op">=</span> <span class="st">"Article"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span>x <span class="op">=</span> <span class="fu">guide_axis</span><span class="op">(</span>check.overlap <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/gesis-data_plot1.png"><!-- --></p>
<p>Finally, if you already know a dataset or record you want to look up,
you can use the <code><a href="../reference/gesis_get.html">gesis_get()</a></code> function to search for a
specific record ID. These IDs can be retrieved from the metadata records
returned by <code><a href="../reference/gesis_search.html">gesis_search()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allbus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gesis_get.html">gesis_get</a></span><span class="op">(</span><span class="st">"ZA5272"</span><span class="op">)</span></span>
<span><span class="va">allbus</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;gesis_hit&gt;</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Type:</span> research_data</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">ID:</span> ZA5272</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Title:</span> German General Social Survey - ALLBUS 2018</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Date:</span> 2019</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Persons:</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Diekmann, Andreas</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Hadjar, Andreas</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Kurz, Karin</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Rosar, Ulrich</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Wagner, Ulrich</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> ... and 1 more</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-retrieval">Data retrieval<a class="anchor" aria-label="anchor" href="#data-retrieval"></a>
</h2>
<p>Both of the last two steps ultimately help to retrieve survey data
from the GESIS data archive. First, authentication is needed to be
allowed to download in the first place. Second, a metadata record (or at
least a record ID) is needed to specify what dataset you want to
download. Accordingly, we can simply use the allbus record we queried
above to download a .sav file from GESIS.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gesis_data.html">gesis_data</a></span><span class="op">(</span><span class="va">allbus</span>, select <span class="op">=</span> <span class="st">"\\.sav"</span><span class="op">)</span></span></code></pre></div>
<p>Since GESIS files can come in all kinds of file formats, the package
leaves reading the data to the user. In this case, we can use the <a href="https://haven.tidyverse.org/" class="external-link">haven</a> package to read the
downloaded file.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://haven.tidyverse.org" class="external-link">haven</a></span><span class="op">)</span></span>
<span><span class="va">allbus_data</span> <span class="op">&lt;-</span> <span class="fu">read_sav</span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span>
<span><span class="va">allbus_data</span></span>
<span><span class="co">#&gt; ! Multiple files in zip: reading ''ZA5272_v1-0-0.sav''</span></span>
<span><span class="co">#&gt; # A tibble: 3,477 × 708</span></span>
<span><span class="co">#&gt;    za_nr            doi     version respid eastwest german  ep01    ep03    ep04    ep06    lm01    lm02  lm19   </span></span>
<span><span class="co">#&gt;    &lt;dbl+lbl&gt;        &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl+lb&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl&gt; &lt;dbl+l&gt;</span></span>
<span><span class="co">#&gt;  1 5272 [GGSS 2018] doi:10… 1.0.0 …      1 1 [OLD … 1 [YES… 1 [VER… 2 [GOO… 2 [SOM… 3 [THE… 6 [6 D…  75   1 [YES]</span></span>
<span><span class="co">#&gt;  2 5272 [GGSS 2018] doi:10… 1.0.0 …      2 2 [NEW … 1 [YES… 2 [GOO… 4 [BAD] 3 [THE… 3 [THE… 7 [ALL… 240   1 [YES]</span></span>
<span><span class="co">#&gt;  3 5272 [GGSS 2018] doi:10… 1.0.0 …      3 1 [OLD … 1 [YES… 2 [GOO… 2 [GOO… 3 [THE… 2 [SOM… 2 [2 D… 120   1 [YES]</span></span>
<span><span class="co">#&gt;  4 5272 [GGSS 2018] doi:10… 1.0.0 …      4 2 [NEW … 1 [YES… 2 [GOO… 2 [GOO… 3 [THE… 3 [THE… 7 [ALL… 180   1 [YES]</span></span>
<span><span class="co">#&gt;  5 5272 [GGSS 2018] doi:10… 1.0.0 …      5 2 [NEW … 1 [YES… 3 [PAR… 2 [GOO… 3 [THE… 2 [SOM… 7 [ALL…  60   1 [YES]</span></span>
<span><span class="co">#&gt;  6 5272 [GGSS 2018] doi:10… 1.0.0 …      6 1 [OLD … 1 [YES… 1 [VER… 3 [PAR… 3 [THE… 2 [SOM… 3 [3 D… 120   1 [YES]</span></span>
<span><span class="co">#&gt;  7 5272 [GGSS 2018] doi:10… 1.0.0 …      7 1 [OLD … 1 [YES… 3 [PAR… 2 [GOO… 3 [THE… 3 [THE… 7 [ALL… 120   1 [YES]</span></span>
<span><span class="co">#&gt;  8 5272 [GGSS 2018] doi:10… 1.0.0 …      8 1 [OLD … 1 [YES… 2 [GOO… 3 [PAR… 3 [THE… 2 [SOM… 2 [2 D…  60   2 [NO] </span></span>
<span><span class="co">#&gt;  9 5272 [GGSS 2018] doi:10… 1.0.0 …      9 1 [OLD … 1 [YES… 1 [VER… 2 [GOO… 4 [SOM… 3 [THE… 3 [3 D…  60   1 [YES]</span></span>
<span><span class="co">#&gt; 10 5272 [GGSS 2018] doi:10… 1.0.0 …     10 2 [NEW … 1 [YES… 2 [GOO… 2 [GOO… 2 [SOM… 3 [THE… 7 [ALL… 240   1 [YES]</span></span>
<span><span class="co">#&gt; # ℹ 3,467 more rows</span></span>
<span><span class="co">#&gt; # ℹ 695 more variables: lm20 &lt;dbl+lbl&gt;, lm21 &lt;dbl+lbl&gt;, lm22 &lt;dbl+lbl&gt;, lm14 &lt;dbl+lbl&gt;, lm23 &lt;dbl+lbl&gt;,</span></span>
<span><span class="co">#&gt; #   lm24 &lt;dbl+lbl&gt;, pa09 &lt;dbl+lbl&gt;, pa10 &lt;dbl+lbl&gt;, pa11 &lt;dbl+lbl&gt;, pa12 &lt;dbl+lbl&gt;, pa13 &lt;dbl+lbl&gt;,</span></span>
<span><span class="co">#&gt; #   pa14 &lt;dbl+lbl&gt;, pa15 &lt;dbl+lbl&gt;, pa16 &lt;dbl+lbl&gt;, pa17 &lt;dbl+lbl&gt;, pa08a &lt;dbl+lbl&gt;, pa18 &lt;dbl+lbl&gt;,</span></span>
<span><span class="co">#&gt; #   pa19 &lt;dbl+lbl&gt;, pp06 &lt;dbl+lbl&gt;, pp07 &lt;dbl+lbl&gt;, pp08 &lt;dbl+lbl&gt;, pp09 &lt;dbl+lbl&gt;, pp10 &lt;dbl+lbl&gt;,</span></span>
<span><span class="co">#&gt; #   pp12 &lt;dbl+lbl&gt;, pp17 &lt;dbl+lbl&gt;, pp18 &lt;dbl+lbl&gt;, pp19 &lt;dbl+lbl&gt;, pp20 &lt;dbl+lbl&gt;, pp22 &lt;dbl+lbl&gt;,</span></span>
<span><span class="co">#&gt; #   pp60 &lt;dbl+lbl&gt;, pp23 &lt;dbl+lbl&gt;, pp61 &lt;dbl+lbl&gt;, pp62 &lt;dbl+lbl&gt;, pp24 &lt;dbl+lbl&gt;, pp25 &lt;dbl+lbl&gt;, …</span></span>
<span><span class="co">#&gt; # ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">allbus_data</span> <span class="op">&lt;-</span> <span class="va">allbus_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">eastwest</span>, economic_situation <span class="op">=</span> <span class="va">ep01</span>, samesex_marriage <span class="op">=</span> <span class="va">pa12</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">everything</span><span class="op">(</span><span class="op">)</span>, .fns <span class="op">=</span> <span class="op">~</span><span class="fu">as_factor</span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>eastwest <span class="op">=</span> <span class="fu">str_to_title</span><span class="op">(</span><span class="va">eastwest</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">allbus_data</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">economic_situation</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">samesex_marriage</span><span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="fu">position_fill</span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">eastwest</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis_d</span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Same-sex marriages\nshould be illegal"</span>,</span>
<span>    labels <span class="op">=</span> <span class="va">str_to_title</span>,</span>
<span>    direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_discrete</span><span class="op">(</span>labels <span class="op">=</span> <span class="va">str_to_title</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Economic situation"</span>, y <span class="op">=</span> <span class="st">"Share"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/gesis-data_plot2.png"><!-- --></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonas Lieth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
